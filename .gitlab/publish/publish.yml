releasePublish:
  image: $BASE_PUBLISH_IMAGE #harbor.lenovo.com/base/publish:latest
  stage: publish
  rules: !reference [.defaultRules, branches]
  script:
    # You should add or modify your publish commands in this scope
    # Start
    - |-
      bash
      array=(`echo $artifactFullNames | tr ',' ' '` )
      echo "$array"
      for publish in ${array[@]}
      do
        docker push $publish:$publishVersion
      done
    # End
  tags:
    - mec-runner

masterPublish:
  image: $BASE_PUBLISH_IMAGE #harbor.lenovo.com/base/publish:latest
  stage: publish
  variables:
    publishVersion: latest
  script:
    # You should add or modify your publish commands in this scope
    # Start
    - |-
      bash
      array=(`echo $artifactFullNames | tr ',' ' '` )
      echo "$array"
      for publish in ${array[@]}
      do
        docker push $publish:$publishVersion
      done
    # End
  tags:
    - mec-runner
  only:
    - master

mRPublish:
  image: $BASE_PUBLISH_IMAGE #harbor.lenovo.com/base/publish:latest
  stage: publish
  variables:
    publishVersion: $CI_COMMIT_SHORT_SHA
  script:
    # You should add or modify your publish commands in this scope
    # Start
    - |-
      bash
      array=(`echo $artifactFullNames | tr ',' ' '` )
      echo "$array"
      for publish in ${array[@]}
      do
        docker push $publish:$publishVersion
      done
    # End
  tags:
    - mec-runner
  only:
    - merge_requests

stagingPublish:
  image: $BASE_PUBLISH_IMAGE #harbor.lenovo.com/base/publish:latest
  stage: publish
  variables:
    publishVersion: $CI_COMMIT_SHORT_SHA
  script:
    # You should add or modify your publish commands in this scope
    # Start
    - |-
      bash
      array=(`echo $artifactFullNames | tr ',' ' '` )
      echo "$array"
      for publish in ${array[@]}
      do
        docker push $publish:$publishVersion
      done
    # End
  tags:
    - mec-runner
  only:
    - /^staging-.*$/

othersPublish:
  image: $BASE_PUBLISH_IMAGE  #harbor.lenovo.com/base/publish:latest
  stage: publish
  variables:
    publishVersion: $CI_COMMIT_SHORT_SHA
  script:
    # You should add or modify your publish commands in this scope
    # Start
    - |-
      bash
      docker login --username $DOCKER_HARBOR_USER  --password $DOCKER_HARBOR_PASSWD $harbor
      array=(`echo $artifactFullNames | tr ',' ' '` )
      echo "$array"
      for publish in ${array[@]}
      do
        docker push $publish:$publishVersion
      done
    # End
  tags:
    - mec-runner
  except:
    - master
    - /^staging-.*$/
    - lecp-id
    - /^release-.*$/
    - merge_requests