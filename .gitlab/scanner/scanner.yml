image: $BASE_SCANNER_IMAGE
masterScanner:
  stage: scanner
  allow_failure: true
  only:
    - master
  tags:
    - mec-runner
  script:
    - sonar-scanner-4.4.0 -Dsonar.gitlab.project_id=$CI_PROJECT_ID -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME -Dsonar.projectVersion=$CI_COMMIT_SHA -Dsonar.projectName=$CI_PROJECT_PATH -Dsonar.projectKey=$CI_PROJECT_NAME:$CI_PROJECT_ID -Dsonar.branch.name=$CI_COMMIT_REF_NAME -Dsonar.host.url=http://isonar.lenovo.com -Dsonar.sourceEncoding=UTF-8

mRScanner:
  stage: scanner
  allow_failure: true
  only:
    - merge_requests
  tags:
    - mec-runner
  script:
    - sonar-scanner-4.4.0 -Dsonar.gitlab.project_id=$CI_PROJECT_ID -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME -Dsonar.projectVersion=$CI_COMMIT_SHA -Dsonar.projectName=$CI_PROJECT_PATH -Dsonar.projectKey=$CI_PROJECT_NAME:$CI_PROJECT_ID -Dsonar.branch.name=$CI_COMMIT_REF_NAME -Dsonar.host.url=http://isonar.lenovo.com -Dsonar.sourceEncoding=UTF-8

#releaseScanner:
#  stage: scanner
#  allow_failure: true
#  only:
#    - /^release-.*$/
#  tags:
#    - mec-runner
#  script:
#    - sonar-scanner-4.4.0 -Dsonar.gitlab.project_id=$CI_PROJECT_ID -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME -Dsonar.projectVersion=$CI_COMMIT_SHA -Dsonar.projectName=$CI_PROJECT_PATH -Dsonar.projectKey=$CI_PROJECT_NAME:$CI_PROJECT_ID -Dsonar.branch.name=$CI_COMMIT_REF_NAME -Dsonar.host.url=http://isonar.lenovo.com -Dsonar.sourceEncoding=UTF-8

stagingScanner:
  stage: scanner
  allow_failure: true
  only:
    - /^staging-.*$/
  tags:
    - mec-runner
  script:
    - sonar-scanner-4.4.0 -Dsonar.gitlab.project_id=$CI_PROJECT_ID -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME -Dsonar.projectVersion=$CI_COMMIT_SHA -Dsonar.projectName=$CI_PROJECT_PATH -Dsonar.projectKey=$CI_PROJECT_NAME:$CI_PROJECT_ID -Dsonar.branch.name=$CI_COMMIT_REF_NAME -Dsonar.host.url=http://isonar.lenovo.com -Dsonar.sourceEncoding=UTF-8

othersScanner:
  stage: scanner
  allow_failure: true
  except:
    - /^release-.*$/
    - /^staging-.*$/
    - master
    - merge_requests
  tags:
    - mec-runner
  script:
    - sonar-scanner-4.4.0 -Dsonar.gitlab.project_id=$CI_PROJECT_ID -Dsonar.gitlab.commit_sha=$CI_COMMIT_SHA -Dsonar.gitlab.ref_name=$CI_COMMIT_REF_NAME -Dsonar.projectVersion=$CI_COMMIT_SHA -Dsonar.projectName=$CI_PROJECT_PATH -Dsonar.projectKey=$CI_PROJECT_NAME:$CI_PROJECT_ID -Dsonar.branch.name=$CI_COMMIT_REF_NAME -Dsonar.host.url=http://isonar.lenovo.com -Dsonar.sourceEncoding=UTF-8
